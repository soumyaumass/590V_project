<!DOCTYPE HTML>
<!--
	Stellar by HTML5 UP
	html5up.net | @ajlkn
	Free for personal and commercial use under the CCA 3.0 license (html5up.net/license)
-->
<html>
	<head>
		<title>590V Project Demo</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		<noscript><link rel="stylesheet" href="assets/css/noscript.css" /></noscript>
		<style>
			#bio_options{
			 width:200px;
			 height:40px;
			 float: right;
			 position: relative;
			 left: -75px;
			}
			#event_options{
			 width:200px;
			 height:40px;
			 float: right;
			 position: relative;
			 left: -75px;
			}
			#movie_names{
			 width:200px;
			 height:40px;
			 float: right;
			 position: relative;
			 left: -75px;
			}
			#bar_chart{
			 width:200px;
			 height:40px;
			 float: right;
			 position: relative;
			 left: -75px;
			}
			#chart {
			 padding: 10px 10px 20px 50px;
			 position: relative;
			 margin-top: 10px;
			 margin-left: 10px;	
			}
			.bar {
			 background-color: blue;
			 height: 20px;
			 margin-top: 2px;
			}
			.major0 {
			 position: relative;
			 left: 75px;
			}
			.major1 {
			 position: relative;
			 left: 75px;
			}
			.major2 {
			 position: relative;
			 left: 75px;
			}
			.major3 {
			 position: relative;
			 left: 75px;
			}
			rect:hover {
				fill: orange;
			}
			#tooltipx {
				position: absolute;
				width: 200px;
				height: auto;
				padding: 10px;
				background-color: black;
				-webkit-border-radius: 10px;
				-moz-border-radius: 10px;
				border-radius: 10px;
				-webkit-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
				-moz-box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
				box-shadow: 4px 4px 10px rgba(0, 0, 0, 0.4);
				pointer-events: none;
				visibility: hidden;
			}
			
			
			#tooltipx p {
				margin: 0;
				font-family: sans-serif;
				font-size: 16px;
				line-height: 20px;
			}
		</style>

	</head>
	<body class="is-preload">
		<!-- Wrapper -->
			<div id="tooltipx" class="hidden">
				<p><strong>Start : </strong><span id="value1">100</span></p>
				<p><strong>End : </strong><span id="value2">100</span></p>
			</div>
			<div id="wrapper">

				<!-- Header -->
					<header id="header" class="alt">
						<span class="logo"><img src="images/logo.svg" alt="" /></span>
						<h1>How true are "True Stories"?</h1>
						<p> Soumya Saha, Sreeparna Mukherjee, Subhajit Naskar <br />
						</header>

				<!-- Nav -->
					<nav id="nav">
						<ul>
							<li><a href="#intro" class="active">Introduction</a></li>
							<li><a href="#Primary">Primary Analysis</a></li>
							<li><a href="#first">Biographical</a></li>
							<li><a href="#second">True Events</a></li>
							<li><a href="#cta">Icicle Plot</a></li>
						</ul>
					</nav>

				<!-- Main -->
					<div id="main">

						<!-- Introduction -->
							<section id="intro" class="main">
								<div class="spotlight">
									<div class="content">
										<h2><b>In this visualization project, we explored different visualization techniques on the dataset of few Biography and true event based Hollywood movies. The dataset has been curated by David McCandless, Omid Kashan, Dr. Stephanie Tomasevic</b></h2>
									</div>
								</div>
							</section>

						<section id="Primary" class="main special">
								<header class="major0">
									<h1><b>Primary Analysis</b>
										<select name="bar_chart" id="bar_chart">
											  <option value="12 Years a Slave">12 Years a Slave</option>
											  <option value="American Sniper">American Sniper</option>
											  <option value="Bohemain Rhapsody">Bohemain Rhapsody</option>
											  <option value="Bridge of Spies">Bridge of Spies</option>
											  <option value="Captain Phillips">Captain Phillips</option>
											  <option value="Dallas Buyers Club">Dallas Buyers Club</option>
											  <option value="Hidden Figures">Hidden Figures</option>
											  <option value="Lion">Lion</option>
											  <option value="Philomona">Philomona</option>
											  <option value="Rush">Rush</option>
											  <option value="Selma">Selma</option>
											  <option value="Spotlight">Spotlight</option>
											  <option value="The Big Short">The Big Short</option>
											  <option value="The Immitation Game">The Immitation Game</option>
											  <option value="The King's Speech">The King's Speech</option>
											  <option value="The Social Network">The Social Network</option>
											  <option value="Wolf of Wall Street">Wolf of Wall Street</option>
									    </select>
									</h1>
								</header>
								<div id='chart' style="height: 200px; width: 100%;"></div>
								<footer class="major0">
									
								</footer>
							</section>

						<!-- First Section -->

							<section id="first" class="main special">
								<header class="major1">
									<h1><b>Biographical Movies</b>
									<select name="bio_options" id="bio_options">
									  <option value="Flexible">Flexible</option>
									  <option value="Creative freedom">Creative freedom</option>
									  <option value="Pedantic">Pedantic</option>
									</select></h1>
									


								</header>

								<div class="TheSocialNetwork">
									<h3 align = LEFT><b>The Social Network (2010)</b></h3>
									<div class = "Comparison">
									</div>
								</div>
								<div class="Selma">
									<h3 align = LEFT><b>Selma (2014)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="TYearsaSlave">
									<h3 align = LEFT><b>12 Years a Slave (2013)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="AmericanSniper">
									<h3 align = LEFT><b>American Sniper (2014)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="Lion">
									<h3 align = LEFT><b>Lion (2016)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="BohemianRhapsody">
									<h3 align = LEFT><b>Bohemian Rhapsody (2018)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="DallasBuyersClub">
									<h3 align = LEFT><b>Dallas Buyers Club (2013)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="TheKingsSpeech">
									<h3 align = LEFT><b>The King's Speech (2010)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="WolfofWallStreet">
									<h3 align = LEFT><b>The Wolf of Wall Street (2013)</b></h3>
									<div class = "Comparison">
									</div>
								</div>

								<div class="TheImitationGame">
									<h3 align = LEFT><b>The Imitation Game (2014)</b></h3>	
									<div class = "Comparison">
									</div>
								</div>

								<footer class="major1">
									
								</footer>
							</section>

						<!-- Second Section -->
							<section id="second" class="main special">
								<header class="major2">
									<h1><b>True Events</b><select name="event_options" id="event_options">
									  <option value="Flexible">Flexible</option>
									  <option value="Creative freedom">Creative freedom</option>
									  <option value="Pedantic">Pedantic</option>
									</select></h1>
								</header>

								<div class="BridgeofSpies">
									<h3 align = LEFT><b>Bridge of Spies (2015)</b></h3>
								</div>

								<div class="CaptainPhillips">
									<h3 align = LEFT><b>Captain Phillips (2013)</b></h3>
								</div>

								<div class="HiddenFigures">
									<h3 align = LEFT><b>Hidden Figures (2016)</b></h3>
								</div>

								<div class="Philomena">
									<h3 align = LEFT><b>Philomena (2013)</b></h3>
								</div>

								<div class="Rush">
									<h3 align = LEFT><b>Rush (2013)</b></h3>
								</div>

								<div class="Spotlight">
									<h3 align = LEFT><b>Spotlight (2015)</b></h3>
								</div>

								<div class="TheBigShort">
									<h3 align = LEFT><b>The Big Short (2015)</b></h3>
								</div>
								
								<footer class="major2">
									
								</footer>
							</section>

						<!-- Get Started -->
							<section id="cta" class="main special">
								<header class="major3">
									<h1><b>Icicle Plot</b> <select name="movie_names" id="movie_names">
									  <option value="TheSocialNetwork">The Social Network</option>
									  <option value="BridgeofSpies">Bridge of Spies</option>
									  <option value="HiddenFigures">Hidden Figures</option>
									  <option value="Selma">Selma</option>
									  <option value="AmericanSniper">American Sniper</option>
									  <option value="BohemianRhapsody">Bohemian Rhapsody</option>
									  <option value="DallasBuyersClub">Dallas Buyers Club</option>
									  <option value="Rush">Rush</option>
									  <option value="Spotlight">Spotlight</option>
									  <option value="TheBigShort">The Big Short</option>
									  <option value="TheImitationGame">The Imitation Game</option>
									  <option value="12YearsaSlave">12 Years a Slave</option>
									  <option value="Lion">Lion</option>
									</select>
									</h1>
									</header>
									<div class="first_level">

									</div>
									<div class="second_level">

									</div>
									<div class="third_level">

									</div>
									<div class="fourth_level">

									</div>
									<div class="fifth_level">

									</div>

								<footer class="major3">
									
								</footer>
							</section>

					</div>


				<!-- Footer -->
					<footer id="footer">
						<section>
							
						</section>
						<section>
							
						</section>
						<p class="copyright">&copy; Untitled. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
					</footer>

			</div>

		<!-- Scripts -->
			<script src='https://d3js.org/d3.v4.min.js'></script>
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/jquery.scrollex.min.js"></script>
			<script src="assets/js/jquery.scrolly.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>
			<script src="canvas.js"></script>
			<script type="text/javascript">

			var chart = new CanvasJS.Chart("chart", {
						animationEnabled: true,
						title:{
							text: "12 Years a Slave",
							horizontalAlign: "left"
						},
						data: [{
							type: "doughnut",
							startAngle: 60,
							//innerRadius: 60,
							indexLabelFontSize: 17,
							indexLabel: "{label} - #percent%",
							toolTipContent: "<b>{label}:</b> {y} (#percent%)",
							dataPoints: [
								{ y: 21, label: "Dramatic License" },
								{ y: 19, label: "Narrative Convenience" },
								{ y: 9, label: "Character Development" }
							]
						}]
					});
					chart.render();

			d3.select('#bar_chart')
                .on('change', function() {
                	movie_name = (d3.select(this).property('value'))

					if ( movie_name == '12 Years a Slave'){
						var data = [ 21, 19, 9]
					}       
					else if(movie_name == 'Lion'){
						var data = [ 5,	1,	4]
					}
					else if(movie_name == 'American Sniper'){
						var data = [ 5	,2, 	3]
					}
					else if(movie_name == 'Bohemain Rhapsody'){
						var data = [ 3.5,	1,	5.5]
					}
					else if(movie_name == 'Bridge of Spies'){
						var data = [ 23,	7,	8]
					}
					else if(movie_name == 'Captain Phillips'){
						var data = [ 31,	26,	20]
					}
					else if(movie_name == 'Dallas Buyers Club'){
						var data = [ 25,	3,	43]
					}
					else if(movie_name == 'Hidden Figures'){
						var data = [ 4,	2,	4]
					}
					else if(movie_name == 'Philomona'){
						var data = [ 22,	8,	35]
					}
					else if(movie_name == 'Rush'){
						var data = [ 10,2,11]
					}
					else if(movie_name == 'Selma'){
						var data = [ 3,3,7]
					}
					else if(movie_name == 'Spotlight'){
						var data = [ 20,1,17]
					}
					else if(movie_name == 'The Big Short'){
						var data = [ 2,11,4]
					}
					else if(movie_name == 'The Immitation Game'){
						var data = [8,0.5,1.5]
					}
					else if(movie_name == 'The King\'s Speech'){
						var data = [18,1,26]
					}
					else if(movie_name == 'The Social Network'){
						var data = [ 12,9,16]
					}
					else{
						var data = [31,11,1]
					}

					var chart = new CanvasJS.Chart("chart", {
						animationEnabled: true,
						title:{
							text: movie_name,
							horizontalAlign: "left"
						},
						data: [{
							type: "doughnut",
							startAngle: 60,
							//innerRadius: 60,
							indexLabelFontSize: 17,
							indexLabel: "{label} - #percent%",
							toolTipContent: "<b>{label}:</b> {y} (#percent%)",
							dataPoints: [
								{ y: data[0], label: "Dramatic License" },
								{ y: data[1], label: "Narrative Convenience" },
								{ y: data[2], label: "Character Development" }
							]
						}]
					});
					chart.render();
				});

			//Width and height
			var bio_dataset = ["TheSocialNetwork.csv","Selma.csv","12YearsaSlave.csv","AmericanSniper.csv","Lion.csv","BohemianRhapsody.csv","DallasBuyersClub.csv","TheKingsSpeech.csv","WolfofWallStreet.csv", "TheImitationGame.csv"];
			var event_dataset = ["BridgeofSpies.csv","CaptainPhillips.csv","HiddenFigures.csv","Philomena.csv","Rush.csv","Spotlight.csv","TheBigShort.csv"];
			var w = 0.9*document.getElementById("first").offsetWidth;
			var h = 70;
			var padding = 0;

			// for biography movies default pedantry
			var bio_film_tooltip = [];
			var bio_real_tooltip = [];
			var bio_pedantry = "Flexible";
			var bio_id = 0;
			for(i = 0; i < 10; i++) {
				d3.csv("./data/Cleaned_data/"+bio_dataset[i], function(data) {
					var div_names = ["TheSocialNetwork", "Selma","TYearsaSlave","AmericanSniper","Lion","BohemianRhapsody","DallasBuyersClub","TheKingsSpeech","WolfofWallStreet", "TheImitationGame"];
					var dataset = data;
					var sum = 0;
					var prev_sum = 0;

					xScale = d3.scaleTime()
								   .domain([
										0,
										d3.sum(dataset, function(d) { return d.duration; })  // 7137
									])
								   .range([padding, w - padding]);

					var div_name = "." + div_names[bio_id]; 
					bio_id++;

					var tooltip = d3.select(div_name)
                            .append("div")
                            .style("position", "absolute")
                            //.style("z-index", "10")
                            .style("visibility", "hidden")
                            .style("text-align", "left")
                            //.style("color", "red")
                            .text("a simple tooltip")
                            .attr("fill", "#FF1491")
                            .attr("x", 0)
                            .attr("y", 0);
                    bio_film_tooltip.push(tooltip);


                    var tooltip2 = d3.select(div_name)
                            .append("div")
                            //.style("position", "absolute")
                            //.style("z-index", "10")
                            .style("visibility", "hidden")
                            .style("text-align", "right")
                            .style("color", "green")
                            .text("a simple tooltip")
                            .attr("fill", "#FF1491")
                            .attr("x", 500)
                            .attr("y", 0);

                    bio_real_tooltip.push(tooltip2);


					var svg = d3.select(div_name)
						.append("svg")
						.attr("width", w)
						.attr("height", h);

					svg.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +d.duration;
					   		return xScale(prev_sum);
					   })
					   .attr("y", 0)
					   .attr("width", function(d) {
					   		return xScale(+d.duration);
					   })
					   .attr("height", 70)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
		   							return "#EC407A";
		   							break;
		   						case 1: {
		   							if(bio_pedantry == "Flexible") return "#F06292";
		   							else return "#EC407A";
		   							break;
		   						}
		   						case 2: {
		   							if(bio_pedantry == "Pedantic") return "#EC407A";
		   							else return "#6d96ad";
		   							break;
		   						}
		   						case 3:
		   							return "#3b7393";
		   							break;
		   						case -1:
		   							return "#a8a895";
		   							break;
		   						default:
		   							return "#bdbf91";
		   							break;
					   		} 
						})
					   .on("mouseenter", function(d) {
			   				console.log(d);  
			   				//var rectsvg = svg.selectAll("rect").attr("height", function(d) {return 100;});
			   				//var test = svg.selectAll("rect").__proto__; //select(this);
			   				//console.log(test);
			   				tooltip.transition()
			   					   .style("visibility", "visible")
			   					   .style("font-family", "sans-serif")
			   					   .style("font-weight", "bold");
			   					   //.style("font-style", "italic")
			   					   //.style("color", "red");

			   				switch(+d.truth_int) {
			   					case 0: 
			   						tooltip.style("color", "red");
			   						break;
			   					case 1:
			   						tooltip.style("color", "red");
			   						break;
			   					case 2:{
			   						if(bio_pedantry == "Pedantic") tooltip.style("color", "red");
			   						else tooltip.style("color", "green");
			   						break;
			   					} 
			   					default:
			   						tooltip.style("color", "green");
			   						break;
			   				}
			   				tooltip.html(d.film_condensed);
			   				
			   				tooltip2.transition()
			   						.style("visibility", "visible")
			   						.style("font-weight", "bold")
			   						.style("font-family", "sans-serif");
			   						//.style("font-style", "italic");
			   				tooltip2.html(d.reality_condensed);

			   				d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
			  		 	})
					   .on("mouseleave", function() {
					   		console.log("mouse leaves");

					   		var rectsvg = svg.selectAll("rect").attr("height", 70);
					   		tooltip.style("visibility", "hidden");
					   		tooltip2.style("visibility", "hidden");
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });   
				});
			}


			// for biography movies changeable pedantry
			d3.select('#bio_options')
                .on('change', function() {
              	bio_pedantry = d3.select(this).property('value');
              	bio_id = 0;

              	for(i = 0; i < 10; i++) {
					d3.csv("./data/Cleaned_data/"+bio_dataset[i], function(data) {
					var div_names = ["TheSocialNetwork", "Selma","TYearsaSlave","AmericanSniper","Lion","BohemianRhapsody","DallasBuyersClub","TheKingsSpeech","WolfofWallStreet", "TheImitationGame"];
					var dataset = data;
					var sum = 0;
					var prev_sum = 0;

					xScale = d3.scaleTime()
								   .domain([
										0,
										d3.sum(dataset, function(d) { return d.duration; })
									])
								   .range([padding, w - padding]);

					var div_name = "." + div_names[bio_id];
					var tooltip = bio_film_tooltip[bio_id]
                    var tooltip2 = bio_real_tooltip[bio_id]
					bio_id++;

					d3.select(div_name).select("svg").remove();
                   
					var svg = d3.select(div_name)
						.append("svg")
						.attr("width", w)
						.attr("height", h);

					svg.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +d.duration;
					   		return xScale(prev_sum);
					   })
					   .attr("y", 0)
					   .attr("width", function(d) {
					   		return xScale(+d.duration);
					   })
					   .attr("height", 70)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
		   							return "#EC407A";
		   							break;
		   						case 1: {
		   							if(bio_pedantry == "Flexible") return "#F06292";
		   							else return "#EC407A";
		   							break;
		   						}
		   						case 2: {
		   							if(bio_pedantry == "Pedantic") return "#EC407A";
		   							else return "#6d96ad";
		   							break;
		   						}
		   						case 3:
		   							return "#3b7393";
		   							break;
		   						case -1:
		   							return "#a8a895";
		   							break;
		   						default:
		   							return "#bdbf91";
		   							break;
					   		} 
					   })
					   .on("mouseenter", function(d) {
			   				console.log(d);  
			   				tooltip.transition()
			   					   .style("visibility", "visible")
			   					   .style("font-family", "sans-serif")
			   					   .style("font-weight", "bold");
			   					   //.style("font-style", "italic")
			   					   //.style("color", "red");

			   				switch(+d.truth_int) {
			   					case 0: 
			   						tooltip.style("color", "red");
			   						break;
			   					case 1:
			   						tooltip.style("color", "red");
			   						break;
			   					case 2:{
			   						if(bio_pedantry == "Pedantic") tooltip.style("color", "red");
			   						else tooltip.style("color", "green");
			   						break;
			   					} 
			   					default:
			   						tooltip.style("color", "green");
			   						break;
			   				}
			   				tooltip.html(d.film_condensed);
			   				
			   				tooltip2.transition()
			   						.style("visibility", "visible")
			   						.style("font-weight", "bold")
			   						.style("font-family", "sans-serif");
			   						//.style("font-style", "italic");
			   				tooltip2.html(d.reality_condensed);
			   				d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
			  		 	})
					   .on("mouseleave", function() {
					   		console.log("mouse leaves");
					   		tooltip.style("visibility", "hidden");
					   		tooltip2.style("visibility", "hidden");
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });
					});
				}
			});





            // for event movies default pedantry
            var event_film_tooltip = [];
			var event_real_tooltip = [];
			var event_pedantry = "Flexible";
			var event_id = 0;
			for(j = 0; j < 7; j++) {
				d3.csv("./data/Cleaned_data/"+event_dataset[j], function(data) {
					var div_names = ["BridgeofSpies","CaptainPhillips","HiddenFigures","Philomena","Rush","Spotlight","TheBigShort"];

					var dataset = data;
					var sum = 0;
					var prev_sum = 0;

					xScale = d3.scaleTime()
								   .domain([
										0,
										d3.sum(dataset, function(d) { return d.duration; }) 
									])
								   .range([padding, w - padding]);

					var div_name = "." + div_names[event_id];
					event_id++;


					var tooltip = d3.select(div_name)
                            .append("div")
                            .style("position", "absolute")
                            //.style("z-index", "10")
                            .style("visibility", "hidden")
                            .style("text-align", "left")
                            //.style("color", "red")
                            .text("a simple tooltip")
                            .attr("fill", "#FF1491")
                            .attr("x", 0)
                            .attr("y", 0);
                    event_film_tooltip.push(tooltip);


                    var tooltip2 = d3.select(div_name)
                            .append("div")
                            //.style("position", "absolute")
                            //.style("z-index", "10")
                            .style("visibility", "hidden")
                            .style("text-align", "right")
                            .style("color", "green")
                            .text("a simple tooltip")
                            .attr("fill", "#FF1491")
                            .attr("x", 500)
                            .attr("y", 0);

                    event_real_tooltip.push(tooltip2);


					var svg = d3.select(div_name)
						.append("svg")
						.attr("width", w)
						.attr("height", h);

					svg.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +d.duration;
					   		return xScale(prev_sum);
					   })
					   .attr("y", 0)
					   .attr("width", function(d) {
					   		return xScale(+d.duration);
					   })
					   .attr("height", 70)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
		   							return "#EC407A";
		   							break;
		   						case 1:
		   							if(event_pedantry == "Flexible") return "#F06292";
		   							else return "#EC407A";
		   							break;
		   						case 2:
		   							if(event_pedantry == "Pedantic") return "#EC407A";
		   							else return "#6d96ad";
		   							break;
		   						case 3:
		   							return "#3b7393";
		   							break;
		   						case -1:
		   							return "#a8a895";
		   							break;
		   						default:
		   							return "#bdbf91";
		   							break;
					   		} 
					   })
					   .on("mouseenter", function(d) {
			   				console.log(d);  
			   				tooltip.transition()
			   					   .style("visibility", "visible")
			   					   .style("font-family", "sans-serif")
			   					   .style("font-weight", "bold");
			   					   //.style("font-style", "italic")
			   					   //.style("color", "red");

			   				switch(+d.truth_int) {
			   					case 0: 
			   						tooltip.style("color", "red");
			   						break;
			   					case 1:
			   						tooltip.style("color", "red");
			   						break;
			   					case 2:{
			   						if(event_pedantry == "Pedantic") tooltip.style("color", "red");
			   						else tooltip.style("color", "green");
			   						break;
			   					} 
			   					default:
			   						tooltip.style("color", "green");
			   						break;
			   				}
			   				tooltip.html(d.film_condensed);
			   				
			   				tooltip2.transition()
			   						.style("visibility", "visible")
			   						.style("font-weight", "bold")
			   						.style("font-family", "sans-serif");
			   						//.style("font-style", "italic");
			   				tooltip2.html(d.reality_condensed);
			   				d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
			  		 	})
					   .on("mouseleave", function() {
					   		console.log("mouse leaves");
					   		tooltip.style("visibility", "hidden");
					   		tooltip2.style("visibility", "hidden");
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });
				});
			}


		//	var movie_names = ["Selma.csv","TheSocialNetwork.csv","12YearsaSlave.csv","AmericanSniper.csv","BohemianRhapsody.csv","BridgeofSpies.csv","CaptainPhillips.csv","DallasBuyersClub.csv","HiddenFigures.csv","Lion.csv","Philomena.csv","Rush.csv","Spotlight.csv","TheBigShort.csv","TheImitationGame.csv","TheKingsSpeech.csv","WolfofWallStreet.csv"];
			// for event movies changeable pedantry
			d3.select('#event_options')
			    .on('change', function() {
              	event_pedantry = d3.select(this).property('value');
              	event_id = 0;

	              	for(j = 0; j < 7; j++) {
						d3.csv("./data/Cleaned_data/"+event_dataset[j], function(data) {
							var div_names = ["BridgeofSpies","CaptainPhillips","HiddenFigures","Philomena","Rush","Spotlight","TheBigShort"];

							var dataset = data;
							var sum = 0;
							var prev_sum = 0;

							xScale = d3.scaleTime()
										   .domain([
												0,
												d3.sum(dataset, function(d) { return d.duration; }) 
											])
										   .range([padding, w - padding]);

							var div_name = "." + div_names[event_id];
							var tooltip = event_film_tooltip[event_id]
		                    var tooltip2 = event_real_tooltip[event_id]
							event_id++;

							d3.select(div_name).select("svg").remove();

							var svg = d3.select(div_name)
								.append("svg")
								.attr("width", w)
								.attr("height", h);

							svg.selectAll("rect")
							   .data(dataset)
							   .enter()
							   .append("rect")
							   .attr("x", function(d) {
							   		prev_sum = sum;
							   		sum += +d.duration;
							   		return xScale(prev_sum);
							   })
							   .attr("y", 0)
							   .attr("width", function(d) {
							   		return xScale(+d.duration);
							   })
							   .attr("height", 70)
							   .attr("fill",  function(d) {
							   		switch(+d.truth_int) {
							   			case 0:
				   							return "#EC407A";
				   							break;
				   						case 1:
				   							if(event_pedantry == "Flexible") return "#F06292";
				   							else return "#EC407A";
				   							break;
				   						case 2:
				   							if(event_pedantry == "Pedantic") return "#EC407A";
				   							else return "#6d96ad";
				   							break;
				   						case 3:
				   							return "#3b7393";
				   							break;
				   						case -1:
				   							return "#a8a895";
				   							break;
				   						default:
				   							return "#bdbf91";
				   							break;
							   		} 
							   })
							   .on("mouseenter", function(d) {
					   				console.log(d);  
					   				tooltip.transition()
					   					   .style("visibility", "visible")
					   					   .style("font-family", "sans-serif")
					   					   .style("font-weight", "bold");
					   					   //.style("font-style", "italic")
					   					   //.style("color", "red");

					   				switch(+d.truth_int) {
					   					case 0: 
					   						tooltip.style("color", "red");
					   						break;
					   					case 1:
					   						tooltip.style("color", "red");
					   						break;
					   					case 2:{
					   						if(event_pedantry == "Pedantic") tooltip.style("color", "red");
					   						else tooltip.style("color", "green");
					   						break;
					   					} 
					   					default:
					   						tooltip.style("color", "green");
					   						break;
					   				}
					   				tooltip.html(d.film_condensed);
					   				
					   				tooltip2.transition()
					   						.style("visibility", "visible")
					   						.style("font-weight", "bold")
					   						.style("font-family", "sans-serif");
					   						//.style("font-style", "italic");
					   				tooltip2.html(d.reality_condensed);
					   				d3.select("#tooltipx")
									.style("left", (d3.event.pageX) + "px")
									.style("top", (d3.event.pageY) + "px")
									.style("visibility", "visible")						
									.select("#value1")
									.text(d.start);
									d3.select("#tooltipx")
									.select("#value2")
									.text(d.end);
					  		 	})
							   .on("mouseleave", function() {
							   		console.log("mouse leaves");
							   		tooltip.style("visibility", "hidden");
							   		tooltip2.style("visibility", "hidden");
							   		d3.select("#tooltipx").style("visibility", "hidden");
							   });
						});
					}
              	});


			    //icicle start 1
			    var w = 0.9*document.getElementById("first").offsetWidth;
			    var max_val;
			    d3.csv("./data/Cleaned_data/TheSocialNetwork.csv", function(data) {
	      			var dataset = data;
					var sum = 0;
					var prev_sum = 0;
					var ice_h = 60;
					max_val = d3.sum(dataset, function(d) { return d.duration; });
					xScale = d3.scaleTime()
								   .domain([
										0,
										d3.sum(dataset, function(d) { return d.duration; })  // 7137
									])
								   .range([padding, w - padding]);

					var level1 = d3.select(".first_level")
						.append("svg")
						.attr("width", w)
						.attr("height", ice_h);

					level1.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +d.duration;
					   		return xScale(prev_sum);
					   })
					   .attr("y", 10)
					   .attr("width", function(d) {
					   		return xScale(+d.duration);
					   })
					   .attr("height", 50)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
					   				return "#EC407A";
					   				break;
					   			case 1:
					   				return "#EC407A"; // "#F06292";
					   				break;
					   			case 2:
					   				return "#EC407A"; //"#6d96ad";
					   				break;
					   			case 3:
					   				return "#3b7393";
					   				break;
					   			case -1:
					   				return "#a8a895";
					   				break;
					   			default:
					   				return "#bdbf91";
					   				break;
					   		} 
					   })
					   .on("mouseenter", function(d) {
							d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
					   })
					   .on("mouseleave", function() {
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });
				});
				
				d3.csv("./data/Cleaned_data/TheSocialNetwork_ice27.csv", function(data) {
					var dataset = data;
					var sum = 0;
					var prev_sum = 0;
					var ice_h = 50;
					xScale_ice = d3.scaleTime()
								   .domain([
										0,
										max_val
									])
								   .range([padding, w - padding]);
					
					var level2 = d3.select(".second_level")
						.append("svg")
						.attr("width", w)
						.attr("height", ice_h);

					level2.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +(d.duration);
					   		return xScale_ice(prev_sum);
					   })
					   .attr("y", 0)
					   .attr("width", function(d) {
					   		return xScale_ice(+d.duration);
					   })
					   .attr("height", 50)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
					   				return "#EC407A";
					   				break;
					   			case 1:
					   				return "#EC407A"; //"#F06292";
					   				break;
					   			case 2:
					   				return "#EC407A"; //"#6d96ad";
					   				break;
					   			case 3:
					   				return "#3b7393";
					   				break;
					   			case -1:
					   				return "#a8a895";
					   				break;
					   			default:
					   				return "#bdbf91";
					   				break;
					   		} 
					   })
					   .on("mouseenter", function(d) {
							d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
					   })
					   .on("mouseleave", function() {
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });
				});

				
				d3.csv("./data/Cleaned_data/TheSocialNetwork_ice9.csv", function(data) {
					var dataset = data;
					var sum = 0;
					var prev_sum = 0;
					var ice_h = 50;
					xScale_ice = d3.scaleTime()
								   .domain([
										0,
										max_val
									])
								   .range([padding, w - padding]);

					var level3 = d3.select(".third_level")
						.append("svg")
						.attr("width", w)
						.attr("height", ice_h);

					level3.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +(d.duration);
					   		return xScale_ice(prev_sum);
					   })
					   .attr("y", 0)
					   .attr("width", function(d) {
					   		return xScale_ice(+d.duration);
					   })
					   .attr("height", 50)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
					   				return "#EC407A";
					   				break;
					   			case 1:
					   				return "#EC407A"; //"#F06292";
					   				break;
					   			case 2:
					   				return "#EC407A"; // "#6d96ad";
					   				break;
					   			case 3:
					   				return "#3b7393";
					   				break;
					   			case -1:
					   				return "#a8a895";
					   				break;
					   			default:
					   				return "#bdbf91";
					   				break;
					   		} 
					   })
					   .on("mouseenter", function(d) {
							d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
					   })
					   .on("mouseleave", function() {
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });
				});
				
				d3.csv("./data/Cleaned_data/TheSocialNetwork_ice3.csv", function(data) {
					var dataset = data;
					var sum = 0;
					var prev_sum = 0;
					var ice_h = 50;
					xScale_ice = d3.scaleTime()
								   .domain([
										0,
										max_val
									])
								   .range([padding, w - padding]);
					
					var level4 = d3.select(".fourth_level")
						.append("svg")
						.attr("width", w)
						.attr("height", ice_h);

					level4.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +(d.duration);
					   		return xScale_ice(prev_sum);
					   })
					   .attr("y", 0)
					   .attr("width", function(d) {
					   		return xScale_ice(+d.duration);
					   })
					   .attr("height", 50)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
					   				return "#EC407A";
					   				break;
					   			case 1:
					   				return "#EC407A"; //"#F06292";
					   				break;
					   			case 2:
					   				return "#EC407A"; //"#6d96ad";
					   				break;
					   			case 3:
					   				return "#3b7393";
					   				break;
					   			case -1:
					   				return "#a8a895";
					   				break;
					   			default:
					   				return "#bdbf91";
					   				break;
					   		} 
					   })
					   .on("mouseenter", function(d) {
							d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
					   })
					   .on("mouseleave", function() {
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });
				});
				
				d3.csv("./data/Cleaned_data/TheSocialNetwork_ice1.csv", function(data) {

					var dataset = data;
					var sum = 0;
					var prev_sum = 0;
					var ice_h = 50;
					xScale_ice = d3.scaleTime()
								   .domain([
										0,
										max_val
									])
								   .range([padding, w - padding]);
					
					var level5 = d3.select(".fifth_level")
						.append("svg")
						.attr("width", w)
						.attr("height", ice_h);

					level5.selectAll("rect")
					   .data(dataset)
					   .enter()
					   .append("rect")
					   .attr("x", function(d) {
					   		prev_sum = sum;
					   		sum += +(d.duration);
					   		return xScale_ice(prev_sum);
					   })
					   .attr("y", 0)
					   .attr("width", function(d) {
					   		return xScale_ice(+d.duration);
					   })
					   .attr("height", 50)
					   .attr("fill",  function(d) {
					   		switch(+d.truth_int) {
					   			case 0:
					   				return "#EC407A";
					   				break;
					   			case 1:
					   				return "#EC407A"; //"#F06292";
					   				break;
					   			case 2:
					   				return "#EC407A"; //"#6d96ad";
					   				break;
					   			case 3:
					   				return "#3b7393";
					   				break;
					   			case -1:
					   				return "#a8a895";
					   				break;
					   			default:
					   				return "#bdbf91";
					   				break;
					   		} 
					   })
					   .on("mouseenter", function(d) {
							d3.select("#tooltipx")
							.style("left", (d3.event.pageX) + "px")
							.style("top", (d3.event.pageY) + "px")
							.style("visibility", "visible")						
							.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
					   })
					   .on("mouseleave", function() {
					   		d3.select("#tooltipx").style("visibility", "hidden");
					   });
		      		});



			    d3.select('#movie_names')
			      .on('change', function() {
						var max_val_new;
			      		movie_name = d3.select(this).property('value');
              			console.log(movie_name);
			      		d3.csv("./data/Cleaned_data/"+ movie_name + ".csv", function(data) {

			      			var dataset = data;
							var sum = 0;
							var prev_sum = 0;
							var ice_h = 60;
							max_val_new = d3.sum(dataset, function(d) { return d.duration; });
							xScale = d3.scaleTime()
										   .domain([
												0,
												d3.sum(dataset, function(d) { return d.duration; })  // 7137
											])
										   .range([padding, w - padding]);

							d3.select(".first_level").select("svg").remove();

							var svg = d3.select(".first_level")
								.append("svg")
								.attr("width", w)
								.attr("height", ice_h);

							svg.selectAll("rect")
							   .data(dataset)
							   .enter()
							   .append("rect")
							   .attr("x", function(d) {
							   		prev_sum = sum;
							   		sum += +d.duration;
							   		return xScale(prev_sum);
							   })
							   .attr("y", 10)
							   .attr("width", function(d) {
							   		return xScale(+d.duration);
							   })
							   .attr("height", 50)
							   .attr("fill",  function(d) {
							   		switch(+d.truth_int) {
							   			case 0:
							   				return "#EC407A";
							   				break;
							   			case 1:
							   				return "#EC407A"; //"#F06292";
							   				break;
							   			case 2:
							   				return "#EC407A"; //"#6d96ad";
							   				break;
							   			case 3:
							   				return "#3b7393";
							   				break;
							   			case -1:
							   				return "#a8a895";
							   				break;
							   			default:
							   				return "#bdbf91";
							   				break;
							   		} 
							   })
							   .on("mouseenter", function(d) {
									d3.select("#tooltipx")
									.style("left", (d3.event.pageX) + "px")
									.style("top", (d3.event.pageY) + "px")
									.style("visibility", "visible")						
									.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
							   })
							   .on("mouseleave", function() {
							   		d3.select("#tooltipx").style("visibility", "hidden");
							   });
			      		});

			      		d3.csv("./data/Cleaned_data/"+ movie_name + "_ice27.csv", function(data) {
			      			var dataset = data;
							var sum = 0;
							var prev_sum = 0;
							var ice_h = 50;
							xScale_ice = d3.scaleTime()
										   .domain([
												0,
												max_val_new
											])
										   .range([padding, w - padding]);
							
							d3.select(".second_level").select("svg").remove();

							var level2 = d3.select(".second_level")
								.append("svg")
								.attr("width", w)
								.attr("height", ice_h);

							level2.selectAll("rect")
							   .data(dataset)
							   .enter()
							   .append("rect")
							   .attr("x", function(d) {
							   		prev_sum = sum;
							   		sum += +(d.duration);
							   		return xScale_ice(prev_sum);
							   })
							   .attr("y", 0)
							   .attr("width", function(d) {
							   		return xScale_ice(+d.duration);
							   })
							   .attr("height", 50)
							   .attr("fill",  function(d) {
							   		switch(+d.truth_int) {
							   			case 0:
							   				return "#EC407A";
							   				break;
							   			case 1:
							   				return "#EC407A"; //"#F06292";
							   				break;
							   			case 2:
							   				return "#EC407A"; //"#6d96ad";
							   				break;
							   			case 3:
							   				return "#3b7393";
							   				break;
							   			case -1:
							   				return "#a8a895";
							   				break;
							   			default:
							   				return "#bdbf91";
							   				break;
							   		} 
							   })
							   .on("mouseenter", function(d) {
									d3.select("#tooltipx")
									.style("left", (d3.event.pageX) + "px")
									.style("top", (d3.event.pageY) + "px")
									.style("visibility", "visible")						
									.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
							   })
							   .on("mouseleave", function() {
							   		d3.select("#tooltipx").style("visibility", "hidden");
							   });
						});

						
						d3.csv("./data/Cleaned_data/"+ movie_name + "_ice9.csv", function(data) {
							var dataset = data;
							var sum = 0;
							var prev_sum = 0;
							var ice_h = 50;
							xScale_ice = d3.scaleTime()
										   .domain([
												0,
												max_val_new
											])
										   .range([padding, w - padding]);

							d3.select(".third_level").select("svg").remove();
							var level3 = d3.select(".third_level")
								.append("svg")
								.attr("width", w)
								.attr("height", ice_h);

							level3.selectAll("rect")
							   .data(dataset)
							   .enter()
							   .append("rect")
							   .attr("x", function(d) {
							   		prev_sum = sum;
							   		sum += +(d.duration);
							   		return xScale_ice(prev_sum);
							   })
							   .attr("y", 0)
							   .attr("width", function(d) {
							   		return xScale_ice(+d.duration);
							   })
							   .attr("height", 50)
							   .attr("fill",  function(d) {
							   		switch(+d.truth_int) {
							   			case 0:
							   				return "#EC407A";
							   				break;
							   			case 1:
							   				return "#EC407A"; //"#F06292";
							   				break;
							   			case 2:
							   				return "#EC407A"; // "#6d96ad";
							   				break;
							   			case 3:
							   				return "#3b7393";
							   				break;
							   			case -1:
							   				return "#a8a895";
							   				break;
							   			default:
							   				return "#bdbf91";
							   				break;
							   		} 
							   })
							   .on("mouseenter", function(d) {
									d3.select("#tooltipx")
									.style("left", (d3.event.pageX) + "px")
									.style("top", (d3.event.pageY) + "px")
									.style("visibility", "visible")						
									.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
							   })
							   .on("mouseleave", function() {
							   		d3.select("#tooltipx").style("visibility", "hidden");
							   });
						});
						
						d3.csv("./data/Cleaned_data/"+ movie_name + "_ice3.csv", function(data) {
							var dataset = data;
							var sum = 0;
							var prev_sum = 0;
							var ice_h = 50;
							xScale_ice = d3.scaleTime()
										   .domain([
												0,
												max_val_new
											])
										   .range([padding, w - padding]);
							
							d3.select(".fourth_level").select("svg").remove();

							var level4 = d3.select(".fourth_level")
								.append("svg")
								.attr("width", w)
								.attr("height", ice_h);

							level4.selectAll("rect")
							   .data(dataset)
							   .enter()
							   .append("rect")
							   .attr("x", function(d) {
							   		prev_sum = sum;
							   		sum += +(d.duration);
							   		return xScale_ice(prev_sum);
							   })
							   .attr("y", 0)
							   .attr("width", function(d) {
							   		return xScale_ice(+d.duration);
							   })
							   .attr("height", 50)
							   .attr("fill",  function(d) {
							   		switch(+d.truth_int) {
							   			case 0:
							   				return "#EC407A";
							   				break;
							   			case 1:
							   				return "#EC407A"; //"#F06292";
							   				break;
							   			case 2:
							   				return "#EC407A"; //"#6d96ad";
							   				break;
							   			case 3:
							   				return "#3b7393";
							   				break;
							   			case -1:
							   				return "#a8a895";
							   				break;
							   			default:
							   				return "#bdbf91";
							   				break;
							   		} 
							   })
							   .on("mouseenter", function(d) {
									d3.select("#tooltipx")
									.style("left", (d3.event.pageX) + "px")
									.style("top", (d3.event.pageY) + "px")
									.style("visibility", "visible")						
									.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
							   })
							   .on("mouseleave", function() {
							   		d3.select("#tooltipx").style("visibility", "hidden");
							   });
						});
						
						d3.csv("./data/Cleaned_data/"+ movie_name + "_ice1.csv", function(data) {

							var dataset = data;
							var sum = 0;
							var prev_sum = 0;
							var ice_h = 50;
							xScale_ice = d3.scaleTime()
										   .domain([
												0,
												max_val_new
											])
										   .range([padding, w - padding]);
							
							d3.select(".fifth_level").select("svg").remove();
							var level5 = d3.select(".fifth_level")
								.append("svg")
								.attr("width", w)
								.attr("height", ice_h);

							level5.selectAll("rect")
							   .data(dataset)
							   .enter()
							   .append("rect")
							   .attr("x", function(d) {
							   		prev_sum = sum;
							   		sum += +(d.duration);
							   		return xScale_ice(prev_sum);
							   })
							   .attr("y", 0)
							   .attr("width", function(d) {
							   		return xScale_ice(+d.duration);
							   })
							   .attr("height", 50)
							   .attr("fill",  function(d) {
							   		switch(+d.truth_int) {
							   			case 0:
							   				return "#EC407A";
							   				break;
							   			case 1:
							   				return "#EC407A"; //"#F06292";
							   				break;
							   			case 2:
							   				return "#EC407A"; //"#6d96ad";
							   				break;
							   			case 3:
							   				return "#3b7393";
							   				break;
							   			case -1:
							   				return "#F06292";
							   				break;
							   			default:
							   				return "#bdbf91";
							   				break;
							   		} 
							   })
							   .on("mouseenter", function(d) {
									d3.select("#tooltipx")
									.style("left", (d3.event.pageX) + "px")
									.style("top", (d3.event.pageY) + "px")
									.style("visibility", "visible")						
									.select("#value1")
							.text(d.start);
							d3.select("#tooltipx")
							.select("#value2")
							.text(d.end);
							   })
							   .on("mouseleave", function() {
							   		d3.select("#tooltipx").style("visibility", "hidden");
							   });
		      		});

			    });
			</script>
	</body>
</html>